(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"34qK":function(e,n,t){"use strict";t.r(n),t.d(n,"_frontmatter",(function(){return r})),t.d(n,"default",(function(){return h}));t("91GP"),t("rGqo"),t("yt8O"),t("Btvt"),t("RW0V"),t("q1tI");var i=t("7ljp"),a=t("013z");t("qKvR");function o(){return(o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}var r={},l=function(e){return function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(i.b)("div",n)}},s=l("InlineNotification"),b=l("Tabs"),c=l("Tab"),u=l("Row"),p=l("Column"),d={_frontmatter:r},m=a.a;function h(e){var n=e.components,t=function(e,n){if(null==e)return{};var t,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)t=o[i],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,["components"]);return Object(i.b)(m,o({},d,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Minikube runs a single-node Kubernetes cluster inside a virtual machine (VM) on your laptop, for users who want to try out Kubernetes or develop with it.\nMinikube documentation is available at ",Object(i.b)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/setup/minikube/"}),"Installing Kubernetes with Minikube"),".\nThe following sections are not a substitute for the official documentation but they get you started in a classic configuration."),Object(i.b)(s,{mdxType:"InlineNotification"},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," Minikube version used to verify this runbook: 1.7.3")),Object(i.b)("p",null,"The following installation steps are described:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Installing Minikube"),Object(i.b)("li",{parentName:"ul"},"Setting up the Docker® registry"),Object(i.b)("li",{parentName:"ul"},"Configuring the hosts file for Minikube"),Object(i.b)("li",{parentName:"ul"},"Starting Minikube"),Object(i.b)("li",{parentName:"ul"},"Enabling Helm for Minikube"),Object(i.b)("li",{parentName:"ul"},"A summary of some useful Minikube commands")),Object(i.b)("h2",null,"Minikube installation"),Object(i.b)("p",null,"Minikube installation steps are described in the official documentation for your preferred Operating System: ",Object(i.b)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/tasks/tools/install-minikube/"}),"Install Minikube"),"."),Object(i.b)("h2",null,"Starting Minikube"),Object(i.b)("p",null,"Minikube can be started with a command as simple as ",Object(i.b)("inlineCode",{parentName:"p"},"minikube start")," without any additional parameters. However, the resulting VM will be too small to deploy an instance of SPM, so several other parameters are required:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"minikube start --vm-driver=virtualbox --cpus 4 --memory 8G --insecure-registry \"192.168.0.0/16\" --disk-size='30G' --kubernetes-version v1.16.7\n")),Object(i.b)("p",null,"Where ",Object(i.b)("inlineCode",{parentName:"p"},"192.168.0.0/16")," is the subnet that contains the IP address that is assigned to the Minikube VM. You can verify the IP address by using the ",Object(i.b)("inlineCode",{parentName:"p"},"minikube ip")," command."),Object(i.b)("p",null,"The IP address might vary depending on your development environment. Therefore, start a Minikube instance to get the IP address and then delete it\nand restart it with the start command. See the note in “Specifying the insecure registry”."),Object(i.b)("h3",null,"Specifying the resource allocation"),Object(i.b)("p",null,"You can add properties to specify the resource allocation. For example:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"--cpus 4")," to use 4 CPUs"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"--memory 8G")," to use 8 GB of RAM"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"--disk-size=30G")," to use 30 GB of disk space")),Object(i.b)("h3",null,"Specifying the VM driver"),Object(i.b)("p",null,"Add the ",Object(i.b)("inlineCode",{parentName:"p"},"--vm-driver=")," option to the ",Object(i.b)("inlineCode",{parentName:"p"},"minikube start")," command to specify the underlying virtual machine driver. The following drivers were tested:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"--vm-driver=virtualbox")," - VirtualBox on OSX and Windows"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"--vm-driver=vmware")," - VMware Fusion on OSX"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"--vm-driver=none")," - Minikube running directly on a Linux® node without virtualization (this is not recommended on personal workstations)")),Object(i.b)("p",null,"The ",Object(i.b)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/tasks/tools/install-minikube/"}),"Install Minikube")," page gives you more information on available VM driver options."),Object(i.b)("h3",null,"Specifying the insecure registry"),Object(i.b)("p",null,"You must specify the ",Object(i.b)("inlineCode",{parentName:"p"},"--insecure-registry")," option to reference the Docker registry that is created. The ",Object(i.b)("inlineCode",{parentName:"p"},"--insecure-registry")," value is the same as specified in the  ",Object(i.b)("inlineCode",{parentName:"p"},"daemon.json")," file."),Object(i.b)(s,{mdxType:"InlineNotification"},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," Because of a limitation in the current version of Minikube, adding the ",Object(i.b)("inlineCode",{parentName:"p"},"--insecure-registry")," option works on a new Minikube instance only.\nIf you start Minikube, be sure to run ",Object(i.b)("inlineCode",{parentName:"p"},"minikube stop")," and ",Object(i.b)("inlineCode",{parentName:"p"},"minikube delete")," before you start it again with the ",Object(i.b)("inlineCode",{parentName:"p"},"--insecure-registry")," option.")),Object(i.b)("h3",null,"Specifying the Kubernetes version"),Object(i.b)("p",null,"You can override the version of Kubernetes that gets installed inside the Minikube VM by using the ",Object(i.b)("inlineCode",{parentName:"p"},"--kubernetes-version")," flag. This flag controls the compatibility between the client tools and the Kubernetes specification."),Object(i.b)("p",null,"If you override the Kubernetes version, ensure that you download and install the corresponding version of ",Object(i.b)("inlineCode",{parentName:"p"},"kubectl")," - this version must be the same version as the Kubernetes cluster."),Object(i.b)(s,{mdxType:"InlineNotification"},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," The ",Object(i.b)("inlineCode",{parentName:"p"},"kubectl")," version running locally and on Minikube should be compatible, so it’s possible to use the ",Object(i.b)("inlineCode",{parentName:"p"},"--kubernetes-version")," flag to keep them consistent.")),Object(i.b)("h2",null,"Docker registry"),Object(i.b)("p",null,"You need a registry to use docker images with Helm in Minikube.\nThere are different types of registries that can be used. However, this page describes a simple registry option that doesn’t require extra components."),Object(i.b)("p",null,"Minikube provides an add-on to run a registry in a container. For more information, see ",Object(i.b)("a",o({parentName:"p"},{href:"https://minikube.sigs.k8s.io/docs/tasks/docker_registry/"}),"How to access the Docker registry within minikube"),"."),Object(i.b)("p",null,"You can use the following command to enable the add-on:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"minikube addons enable registry\n")),Object(i.b)("p",null,"When enabled, starting Minikube starts two pods on the ",Object(i.b)("inlineCode",{parentName:"p"},"kube-system")," namespace, named ",Object(i.b)("inlineCode",{parentName:"p"},"registry")," and ",Object(i.b)("inlineCode",{parentName:"p"},"registry-proxy"),". Now the registry is active and can be used. The registry points to the Minikube IP address on port 5000."),Object(i.b)("p",null,"The containers don’t mount any volumes, so stopping Minikube deletes the registry content."),Object(i.b)("h2",null,"Hostname configuration for Minikube"),Object(i.b)("p",null,"This runbook uses a generic hostname of ",Object(i.b)("inlineCode",{parentName:"p"},"minikube.local")," as an example in commands and the configuration files.\nYou should add the Minikube IP address to the ",Object(i.b)("inlineCode",{parentName:"p"},"hosts")," file by using the generic hostname, or else modify the usage of ",Object(i.b)("inlineCode",{parentName:"p"},"minikube.local")," in this runbook to reflect your local hostname."),Object(i.b)(b,{mdxType:"Tabs"},Object(i.b)(c,{label:"Mac/Linux",mdxType:"Tab"},Object(i.b)(u,{mdxType:"Row"},Object(i.b)(p,{mdxType:"Column"},Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),'echo -e "$(minikube ip)\\tminikube.local" | sudo tee -a /etc/hosts\n'))))),Object(i.b)(c,{label:"Windows",mdxType:"Tab"},Object(i.b)(u,{mdxType:"Row"},Object(i.b)(p,{mdxType:"Column"},Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-powershell"}),'Add-Content -Path C:\\Windows\\System32\\drivers\\etc\\hosts -Value "$(minikube ip)`tminikube.local" -Force\n')))))),Object(i.b)("p",null,"Where ",Object(i.b)("inlineCode",{parentName:"p"},"minikube ip")," is the command that returns the Minikube VM’s IP address that is accessible from your workstation."),Object(i.b)("p",null,"The local Docker client configuration must be also be updated with the corresponding IP address."),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Update the ",Object(i.b)("inlineCode",{parentName:"li"},"daemon.json")," docker configuration file with the Minikube IP address. This file is usually located in:",Object(i.b)("ul",{parentName:"li"},Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"~/.docker/daemon.json")," on OSX"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"/etc/docker/daemon.json")," on Linux"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"C:\\ProgramData\\Docker\\config\\daemon.json")," on Windows")))),Object(i.b)("p",null,"Example of ",Object(i.b)("inlineCode",{parentName:"p"},"daemon.json"),":"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-json"}),'{\n  "insecure-registries": [\n    "192.168.0.0/16"\n  ]\n}\n')),Object(i.b)(s,{mdxType:"InlineNotification"},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," You can provide a specific IP address, or specify a subnet to future-proof the Docker client configuration.")),Object(i.b)("p",null,"The Minikube IP address might change when you run ",Object(i.b)("inlineCode",{parentName:"p"},"minikube delete"),". If it changes, you must repeat these steps."),Object(i.b)("p",null,"Therefore, reconfirm the Minikube IP and its setting in the ",Object(i.b)("inlineCode",{parentName:"p"},"hosts")," file every time you start Minikube, or after you run ",Object(i.b)("inlineCode",{parentName:"p"},"minikube delete"),"."),Object(i.b)("h2",null,"Enabling Helm version 2 to run on Minikube"),Object(i.b)(s,{mdxType:"InlineNotification"},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," This section is only applicable to Helm v2. If you have installed Helm v3, proceed to the next section.")),Object(i.b)("p",null,"To use Helm commands on Minikube, initialize Tiller, which is the Helm server pod within Kubernetes, by running the following commands:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"# Enable Tiller on Minikube to allow executing Helm commands\nkubectl create serviceaccount -n kube-system tiller\nkubectl create clusterrolebinding tiller-cluster-rule --clusterrole=cluster-admin --serviceaccount=kube-system:tiller\n\n# Initialise Helm\nhelm init --service-account tiller\n")),Object(i.b)("p",null,"To verify whether Tiller is properly initialized, run the following command and look for the Tiller pod:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"kubectl get pods -n kube-system | grep tiller\n")),Object(i.b)("p",null,"This command gives you the list of the pods in the system namespace, which is filtered for Tiller. The command returns one line that looks like the following example:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"tiller-deploy-79c578486f-vnrhd              1/1     Running   1          18h\n")),Object(i.b)("h2",null,"Minikube Ingress"),Object(i.b)("p",null,"Ingress is a reverse proxy, which sits in front of the application that is deployed in Kubernetes. It facilitates use of a custom domain name to access a deployed application, instead of using service ports.\nTo enable Ingress for Minikube, you must enable the ",Object(i.b)("inlineCode",{parentName:"p"},"ingress")," add-on."),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"minikube addons enable ingress\n")),Object(i.b)("p",null,"To avoid manipulation of DNS configuration (which requires elevated privileges), you can use a public wildcard DNS service like ",Object(i.b)("inlineCode",{parentName:"p"},"nip.io")," or ",Object(i.b)("inlineCode",{parentName:"p"},"xip.io"),".\nBoth provide ",Object(i.b)("em",{parentName:"p"},"translation")," of domain names to a LAN address, e.g. a domain of ",Object(i.b)("inlineCode",{parentName:"p"},"hello-world.192.168.99.100.nip.io")," will behave as if you have entered ",Object(i.b)("inlineCode",{parentName:"p"},"192.168.99.100")," (replace the IP with your own Minikube IP!) in the address bar.\n“"),Object(i.b)(s,{mdxType:"InlineNotification"},Object(i.b)("p",null,Object(i.b)("strong",{parentName:"p"},"Note:")," Use of these DNS services does not actually expose your local environment to the internet.")),Object(i.b)("h2",null,"Useful Minikube commands"),Object(i.b)("p",null,"Some useful Minikube commands are as follows:"),Object(i.b)("pre",null,Object(i.b)("code",o({parentName:"pre"},{className:"language-shell"}),"# Sample commands\nminikube status       # See if Minikube is running\nminikube start        # Create and start Minikube\nminikube dashboard    # Access the Kubernetes dashboard running within the Minikube cluster\nminikube ssh          # Login into the Minikube VM\nminikube addons list  # Show the status of the available add-ons\nminikube stop         # Stop Minikube\nminikube delete       # Delete the Minikube VM\nminikube ip           # Show the Minikube IP\n")),Object(i.b)("p",null,"For a full list of commands, see ",Object(i.b)("a",o({parentName:"p"},{href:"https://kubernetes.io/docs/setup/minikube/"}),"Kubernetes.io’s Minikube"),"."))}h.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-01-prereq-minikube-mdx-f54121d2c68bf59bb7c1.js.map